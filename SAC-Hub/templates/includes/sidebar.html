<!-- Sidebar -->
<aside id="sidebar"
    class="w-64 bg-white shadow-lg fixed h-full z-20 hidden md:block transition-transform duration-300 ease-in-out md:translate-x-0 -translate-x-full">
    <div class="p-6 border-b flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div
                class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center text-white font-bold text-xl">
                MITS
            </div>
            <span class="font-bold text-gray-800">SAC Hub</span>
        </div>
        <button id="closeSidebarBtn" class="md:hidden p-1 hover:bg-gray-100 rounded transition-colors">
            <i class="bi bi-x-lg text-gray-600"></i>
        </button>
    </div>

    <nav class="p-4 space-y-1 overflow-y-auto h-[calc(100vh-80px)]">
        <div class="mb-6">
            <p class="px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-4">Menu</p>

            <!-- Student Navigation -->
            {% if request.user.roles|length == 0 or 'STUDENT' in request.user.roles %}
            <a href="{% url 'home' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'student-dashboard' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-house-door"></i>
                Home
            </a>
            <a href="{% url 'event_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'event_list' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-calendar-event"></i>
                Events
            </a>
            <a href="{% url 'certificate:home' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if 'certificate' in request.resolver_match.url_name %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-award"></i>
                Certificates
            </a>
            <a href="{% url 'calendar_view' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'calendar_view' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-calendar3"></i>
                Calendar
            </a>
            <a href="{% url 'club_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'club_list' or request.resolver_match.url_name == 'club_detail' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-people"></i>
                Clubs
            </a>

            <a href="{% url 'notifications_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'notifications_list' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-bell"></i>
                Notifications
            </a>
            <a href="{% url 'profile' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'profile' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-person"></i>
                Profile
            </a>
            {% endif %}

            <!-- Club Coordinator Navigation -->
            {% if 'CLUB_COORDINATOR' in request.user.roles %}
            <a href="{% url 'club_detail' coordinator_clubs.0.id %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'club_detail' and request.resolver_match.kwargs.club_id == coordinator_clubs.0.id %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-building"></i>
                My Club
            </a>
            <a href="{% url 'events_management' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'events_management' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-calendar-event"></i>
                Events
            </a>
            <a href="{% if coordinator_clubs %}{% url 'manage_club_members' coordinator_clubs.0.id %}{% else %}#manage-members{% endif %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'manage_club_members' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-people"></i>
                Manage Members
            </a>
            <a href="{% url 'attendance_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'attendance_list' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-check2-all"></i>
                Attendance
            </a>
            <a href="{% url 'notifications_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'notifications_list' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-bell"></i>
                Notifications
            </a>
            <a href="{% url 'profile' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'profile' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-person"></i>
                Profile
            </a>
            {% endif %}

            <!-- Club Advisor Navigation -->
            {% if 'CLUB_ADVISOR' in request.user.roles %}
            <a href="{% url 'club-advisor-dashboard-template' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'club-advisor-dashboard-template' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-speedometer2"></i>
                Dashboard
            </a>
            <a href="{% url 'events_management' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'events_management' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-calendar-check"></i>
                Event Approvals
            </a>
            <a href="{% url 'club_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'club_list' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-collection"></i>
                Clubs
            </a>
            <a href="{% url 'events_management' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'events_management' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-file-earmark-text"></i>
                Reports
            </a>
            <a href="{% url 'notifications_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'notifications_list' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-bell"></i>
                Notifications
            </a>
            <a href="{% url 'profile' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'profile' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-person"></i>
                Profile
            </a>
            {% endif %}

            <!-- Department Admin Navigation -->
            {% if 'ADMIN' in request.user.roles and 'SAC_COORDINATOR' not in request.user.roles %}
            <a href="{% url 'department-admin-dashboard-template' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'department-admin-dashboard-template' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-speedometer2"></i>
                Dashboard
            </a>
            <a href="{% url 'events_management' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'events_management' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-calendar-event"></i>
                Department Events
            </a>
            <a href="{% url 'department-admin-dashboard-template' %}#clubs-management"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'department-admin-dashboard-template' and '#clubs-management' in request.build_absolute_uri %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-building"></i>
                Clubs Management
            </a>
            <a href="{% url 'department-admin-dashboard-template' %}#students"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'department-admin-dashboard-template' and '#students' in request.build_absolute_uri %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-people"></i>
                Students
            </a>
            <a href="{% url 'department-admin-dashboard-template' %}#approvals"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'department-admin-dashboard-template' and '#approvals' in request.build_absolute_uri %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-check-circle"></i>
                Approvals
            </a>
            <a href="{% url 'events_management' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'events_management' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-file-earmark-text"></i>
                Reports
            </a>
            <a href="{% url 'notifications_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'notifications_list' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-bell"></i>
                Notifications
            </a>
            <a href="{% url 'profile' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'profile' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-person"></i>
                Profile
            </a>
            {% endif %}

            <!-- SAC Coordinator Navigation -->
            {% if 'SAC_COORDINATOR' in request.user.roles %}
            <a href="{% url 'admin-dashboard-template' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'admin-dashboard-template' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-speedometer2"></i>
                SAC Dashboard
            </a>
            <a href="{% url 'events_management' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'events_management' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-calendar-event"></i>
                All Events
            </a>
            <a href="{% url 'event_reports' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'event_reports' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-file-earmark-text"></i>
                Event Reports
            </a>
            <a href="{% url 'analytics' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'analytics' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-graph-up"></i>
                Analytics
            </a>
            <a href="{% url 'notifications_list' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'notifications_list' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-bell"></i>
                Notifications
            </a>
            <a href="{% url 'profile' %}"
                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors {% if request.resolver_match.url_name == 'profile' %}bg-red-50 text-red-600{% else %}text-gray-600 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="bi bi-person"></i>
                Profile
            </a>
            {% endif %}
        </div>
    </nav>
</aside>

<!-- Toggle Button -->
<button id="sidebarToggleBtn"
    class="hidden md:hidden fixed top-4 left-4 z-30 p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">
    <i class="bi bi-list text-xl"></i>
</button>

<!-- Overlay -->
<div id="sidebarOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-10 md:hidden"></div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const sidebar = document.getElementById('sidebar');
        const toggleBtn = document.getElementById('sidebarToggleBtn');
        const closeBtn = document.getElementById('closeSidebarBtn');
        const overlay = document.getElementById('sidebarOverlay');
        let isSidebarOpen = false;

        function toggleSidebar() {
            isSidebarOpen = !isSidebarOpen;

            if (isSidebarOpen) {
                sidebar.classList.remove('-translate-x-full');
                sidebar.classList.add('translate-x-0');
                overlay.classList.remove('hidden');
                toggleBtn.classList.add('hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                sidebar.classList.remove('translate-x-0');
                overlay.classList.add('hidden');
                toggleBtn.classList.remove('hidden');
            }
        }

        function closeSidebar() {
            isSidebarOpen = true;
            toggleSidebar();
        }

        if (toggleBtn) toggleBtn.addEventListener('click', toggleSidebar);
        if (closeBtn) closeBtn.addEventListener('click', closeSidebar);
        if (overlay) overlay.addEventListener('click', closeSidebar);

        // Handle window resize
        window.addEventListener('resize', function () {
            if (window.innerWidth >= 768) {
                // Desktop view - always show sidebar
                if (sidebar) {
                    sidebar.classList.add('hidden', 'md:block');
                    sidebar.classList.remove('-translate-x-full');
                }
                if (overlay) overlay.classList.add('hidden');
                if (toggleBtn) toggleBtn.classList.add('hidden');
                isSidebarOpen = false;
            } else {
                // Mobile view
                if (!isSidebarOpen) {
                    if (sidebar) sidebar.classList.add('-translate-x-full');
                    if (toggleBtn) toggleBtn.classList.remove('hidden');
                }
            }
        });

        // Initialize based on screen size
        if (window.innerWidth < 768) {
            if (sidebar) {
                sidebar.classList.remove('hidden');
                sidebar.classList.add('-translate-x-full');
            }
            if (toggleBtn) toggleBtn.classList.remove('hidden');
        }
    });
</script>