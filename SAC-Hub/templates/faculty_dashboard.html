{% extends 'base.html' %}
{% load static %}

{% block title %}Faculty Dashboard - MITS SAC Hub{% endblock %}

{% block content %}
<!-- Faculty Welcome Section -->
<div class="dashboard-welcome">
    <h1>Welcome, Prof. {{ user.get_full_name|default:user.username }}! üë®‚Äçüè´</h1>
    <p>Shape minds beyond the classroom. Guide student initiatives, provide academic perspective to extracurricular activities, and foster holistic development.</p>
</div>

<!-- Faculty Engagement Stats -->
<div class="stats-showcase">
    <div class="stat-card">
        <h3>Students Mentored</h3>
        <div class="number">{{ students_mentored|default:156 }}</div>
        <div class="label">Active Mentorship</div>
    </div>
    <div class="stat-card">
        <h3>Advisory Roles</h3>
        <div class="number">{{ advisory_roles|default:4 }}</div>
        <div class="label">Club Positions</div>
    </div>
    <div class="stat-card">
        <h3>Events Supported</h3>
        <div class="number">{{ events_supported|default:28 }}</div>
        <div class="label">This Academic Year</div>
    </div>
    <div class="stat-card">
        <h3>Impact Score</h3>
        <div class="number">{{ impact_score|default:4.8 }}</div>
        <div class="label">Student Feedback</div>
    </div>
</div>

<!-- Faculty Advisory Tools -->
<div class="card-grid">
    <!-- Student Mentorship -->
    <div class="feature-card">
        <div class="feature-card-header">
            <span class="feature-card-icon">üéì</span>
            <h3>Student Mentorship</h3>
        </div>
        <div class="feature-card-body">
            <p>Guide students in their academic and extracurricular journey. Provide career advice and support personal development.</p>
            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                <a href="/faculty/mentorship/" class="btn btn-primary" style="flex: 1;">Mentorship Portal</a>
                <a href="/faculty/students/" class="btn btn-outline" style="flex: 1;">My Students</a>
            </div>
        </div>
    </div>

    <!-- Club Advisory -->
    <div class="feature-card">
        <div class="feature-card-header">
            <span class="feature-card-icon">üèõÔ∏è</span>
            <h3>Club Advisory</h3>
        </div>
        <div class="feature-card-body">
            <p>Provide strategic guidance to student clubs, review proposals, and ensure academic alignment with activities.</p>
            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                <a href="/faculty/advisory/" class="btn btn-success" style="flex: 1;">Advisory Dashboard</a>
                <a href="/faculty/clubs/" class="btn btn-outline" style="flex: 1;">Assigned Clubs</a>
            </div>
        </div>
    </div>

    <!-- Academic Integration -->
    <div class="feature-card">
        <div class="feature-card-header">
            <span class="feature-card-icon">üî¨</span>
            <h3>Academic Integration</h3>
        </div>
        <div class="feature-card-body">
            <p>Bridge academic learning with practical application through projects, workshops, and research opportunities.</p>
            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                <a href="/faculty/projects/" class="btn btn-accent" style="flex: 1;">Academic Projects</a>
                <a href="/faculty/workshops/" class="btn btn-outline" style="flex: 1;">Workshops</a>
            </div>
        </div>
    </div>

    <!-- Performance Monitoring -->
    <div class="feature-card">
        <div class="feature-card-header">
            <span class="feature-card-icon">üìà</span>
            <h3>Performance Insights</h3>
        </div>
        <div class="feature-card-body">
            <p>Monitor student engagement in extracurricular activities and track their holistic development progress.</p>
            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                <a href="/faculty/analytics/" class="btn btn-primary" style="flex: 1;">View Analytics</a>
                <a href="/faculty/reports/" class="btn btn-outline" style="flex: 1;">Generate Reports</a>
            </div>
        </div>
    </div>
</div>

<!-- Recent Advisory Activities -->
<div class="interactive-section">
    <div class="section-header">
        <h2>Recent Advisory Activities</h2>
        <p>Stay updated with your advisory responsibilities and student interactions</p>
    </div>

    {% if recent_activities %}
    <div class="modern-table">
        <table>
            <thead>
                <tr>
                    <th>Activity Type</th>
                    <th>Student/Club</th>
                    <th>Subject</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Priority</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for activity in recent_activities %}
                <tr>
                    <td>
                        {% if activity.type == 'MENTORSHIP' %}
                            <span class="status-badge" style="background: rgba(44, 90, 160, 0.1); color: var(--primary-main);">üéì Mentorship</span>
                        {% elif activity.type == 'CLUB_ADVISORY' %}
                            <span class="status-badge" style="background: rgba(56, 161, 105, 0.1); color: var(--accent-emerald);">üèõÔ∏è Club Advisory</span>
                        {% elif activity.type == 'PROJECT_REVIEW' %}
                            <span class="status-badge" style="background: rgba(214, 158, 46, 0.1); color: var(--accent-gold);">üî¨ Project Review</span>
                        {% else %}
                            <span class="status-badge">{{ activity.type }}</span>
                        {% endif %}
                    </td>
                    <td><strong>{{ activity.student_or_club }}</strong></td>
                    <td>{{ activity.subject }}</td>
                    <td>{{ activity.date|date:"M d, Y" }}</td>
                    <td>
                        {% if activity.status == 'COMPLETED' %}
                            <span class="status-badge status-success">Completed</span>
                        {% elif activity.status == 'PENDING' %}
                            <span class="status-badge status-warning">Pending</span>
                        {% elif activity.status == 'IN_PROGRESS' %}
                            <span class="status-badge" style="background: rgba(66, 153, 225, 0.1); color: var(--info);">In Progress</span>
                        {% else %}
                            <span class="status-badge">{{ activity.status }}</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if activity.priority == 'HIGH' %}
                            <span class="status-badge status-error">High</span>
                        {% elif activity.priority == 'MEDIUM' %}
                            <span class="status-badge status-warning">Medium</span>
                        {% else %}
                            <span class="status-badge status-success">Low</span>
                        {% endif %}
                    </td>
                    <td>
                        <div style="display: flex; gap: 0.5rem;">
                            <a href="/faculty/activity/{{ activity.id }}/" class="btn btn-primary" style="padding: 0.5rem; font-size: 0.75rem;">Review</a>
                            <a href="/faculty/respond/{{ activity.id }}/" class="btn btn-outline" style="padding: 0.5rem; font-size: 0.75rem;">Respond</a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state">
        <h3>All Caught Up! üìö</h3>
        <p>No pending advisory activities at this time. Your guidance is making a difference!</p>
        <a href="/faculty/students/" class="btn btn-primary">Check on Students</a>
    </div>
    {% endif %}
</div>

<!-- Faculty Impact Dashboard -->
<div class="interactive-section">
    <div class="section-header">
        <h2>Faculty Impact Assessment</h2>
        <p>Measure your contribution to student development and institutional growth</p>
    </div>
    
    <div class="card-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
        <div class="feature-card">
            <div class="feature-card-header">
                <span class="feature-card-icon">üë•</span>
                <h3>Student Engagement</h3>
            </div>
            <div class="feature-card-body">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--accent-emerald); margin-bottom: 0.5rem;">
                    {{ student_engagement_rate|default:94 }}%
                </div>
                <p style="margin-bottom: 1rem;">Students actively engaged in advisory sessions</p>
                <div style="background: var(--surface-tertiary); height: 8px; border-radius: 4px; overflow: hidden;">
                    <div style="background: linear-gradient(90deg, var(--accent-emerald), #48bb78); height: 100%; width: {{ student_engagement_rate|default:94 }}%; border-radius: 4px; transition: width 1s ease;"></div>
                </div>
                <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">Excellent engagement level</small>
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-card-header">
                <span class="feature-card-icon">üéØ</span>
                <h3>Mentorship Success</h3>
            </div>
            <div class="feature-card-body">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary-main); margin-bottom: 0.5rem;">
                    {{ mentorship_success|default:88 }}%
                </div>
                <p style="margin-bottom: 1rem;">Students achieving their set goals</p>
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                    <span style="color: var(--accent-emerald); font-size: 0.875rem;">‚Üó +12%</span>
                    <span style="color: var(--text-muted); font-size: 0.875rem;">improvement this semester</span>
                </div>
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-card-header">
                <span class="feature-card-icon">üèÜ</span>
                <h3>Academic Excellence</h3>
            </div>
            <div class="feature-card-body">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--accent-gold); margin-bottom: 0.5rem;">
                    {{ academic_integration|default:76 }}%
                </div>
                <p style="margin-bottom: 1rem;">Extracurricular activities aligned with academics</p>
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                    <span style="color: var(--accent-gold); font-size: 0.875rem;">üéì High Impact</span>
                    <span style="color: var(--text-muted); font-size: 0.875rem;">on learning outcomes</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Faculty Resources & Tools -->
<div class="interactive-section">
    <div class="section-header">
        <h2>Faculty Resource Center</h2>
        <p>Access tools and resources to enhance your advisory and mentorship capabilities</p>
    </div>
    
    <div class="card-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
        <div style="background: var(--surface-primary); padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); text-align: center; border-left: 4px solid var(--primary-main);">
            <div style="font-size: 2rem; margin-bottom: 0.75rem;">üìñ</div>
            <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Mentorship Guidelines</h4>
            <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">Access best practices and guidelines for effective student mentorship</p>
            <a href="/faculty/guidelines/" class="btn btn-outline" style="width: 100%; padding: 0.75rem;">View Guidelines</a>
        </div>

        <div style="background: var(--surface-primary); padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); text-align: center; border-left: 4px solid var(--accent-emerald);">
            <div style="font-size: 2rem; margin-bottom: 0.75rem;">üéØ</div>
            <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Goal Setting Tools</h4>
            <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">Help students set and track their personal and academic goals</p>
            <a href="/faculty/goal-tools/" class="btn btn-outline" style="width: 100%; padding: 0.75rem;">Access Tools</a>
        </div>

        <div style="background: var(--surface-primary); padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); text-align: center; border-left: 4px solid var(--accent-gold);">
            <div style="font-size: 2rem; margin-bottom: 0.75rem;">üìä</div>
            <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Performance Analytics</h4>
            <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">Track student progress and engagement metrics</p>
            <a href="/faculty/student-analytics/" class="btn btn-outline" style="width: 100%; padding: 0.75rem;">View Analytics</a>
        </div>

        <div style="background: var(--surface-primary); padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); text-align: center; border-left: 4px solid var(--info);">
            <div style="font-size: 2rem; margin-bottom: 0.75rem;">üí¨</div>
            <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Communication Hub</h4>
            <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">Communicate with students and fellow faculty members</p>
            <a href="/faculty/communication/" class="btn btn-outline" style="width: 100%; padding: 0.75rem;">Open Hub</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate faculty impact statistics
    const statNumbers = document.querySelectorAll('.stat-card .number');
    statNumbers.forEach((number, index) => {
        const finalValue = parseFloat(number.textContent);
        let currentValue = 0;
        const isDecimal = finalValue % 1 !== 0;
        const increment = isDecimal ? finalValue / 50 : Math.ceil(finalValue / 50);
        
        const counter = setInterval(() => {
            currentValue += increment;
            if (currentValue >= finalValue) {
                number.textContent = finalValue;
                clearInterval(counter);
            } else {
                number.textContent = isDecimal ? currentValue.toFixed(1) : Math.floor(currentValue);
            }
        }, 30);
    });

    // Enhance activity priority visualization
    document.querySelectorAll('.status-badge.status-error').forEach(badge => {
        const row = badge.closest('tr');
        if (badge.textContent.trim() === 'High' && row) {
            row.style.borderLeft = '3px solid var(--error)';
            row.style.background = 'rgba(245, 101, 101, 0.02)';
        }
    });

    // Faculty-specific interactions
    const facultyButtons = document.querySelectorAll('a[href*="/faculty/"]');
    facultyButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            // Add visual feedback for faculty actions
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = '';
            }, 150);
        });
    });

    // Progress bar animations for faculty metrics
    setTimeout(() => {
        const progressBars = document.querySelectorAll('[style*="width:"][style*="%"]');
        progressBars.forEach((bar, index) => {
            const width = bar.style.width;
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.width = width;
            }, 400 * (index + 1));
        });
    }, 1200);

    // Add mentorship session reminders (example)
    const currentHour = new Date().getHours();
    if (currentHour >= 9 && currentHour <= 17) {
        // During working hours, check for upcoming sessions
        setTimeout(() => {
            // This could be integrated with actual calendar data
            console.log('Checking for upcoming mentorship sessions...');
        }, 2000);
    }
});
</script>
{% endblock %}
