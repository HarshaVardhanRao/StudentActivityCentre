{% extends 'base.html' %}
{% load static %}

{% block title %}Secretary Dashboard - MITS SAC Hub{% endblock %}

{% block content %}
<!-- Secretary Welcome Section -->
<div class="dashboard-welcome">
    <h1>Welcome, Secretary {{ user.get_full_name|default:user.username }}! ğŸ“‹</h1>
    <p>Keep our organization running smoothly. Manage records, facilitate communication, and ensure seamless administrative operations across all club activities.</p>
</div>

<!-- Secretary Management Stats -->
<div class="stats-showcase">
    <div class="stat-card">
        <h3>Records Managed</h3>
        <div class="number">{{ records_managed|default:342 }}</div>
        <div class="label">Total Documents</div>
    </div>
    <div class="stat-card">
        <h3>Communications</h3>
        <div class="number">{{ communications_sent|default:156 }}</div>
        <div class="label">This Month</div>
    </div>
    <div class="stat-card">
        <h3>Meeting Minutes</h3>
        <div class="number">{{ meeting_minutes|default:28 }}</div>
        <div class="label">Documented</div>
    </div>
    <div class="stat-card">
        <h3>Efficiency Rating</h3>
        <div class="number">{{ efficiency_rating|default:4.7 }}</div>
        <div class="label">Team Feedback</div>
    </div>
</div>

<!-- Administrative Tools -->
<div class="card-grid">
    <!-- Records Management -->
    <div class="feature-card">
        <div class="feature-card-header">
            <span class="feature-card-icon">ğŸ“‚</span>
            <h3>Records Management</h3>
        </div>
        <div class="feature-card-body">
            <p>Organize and maintain club records, member information, and important documents. Ensure data accuracy and accessibility.</p>
            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                <a href="/secretary/records/" class="btn btn-primary" style="flex: 1;">Manage Records</a>
                <a href="/secretary/archive/" class="btn btn-outline" style="flex: 1;">Archive</a>
            </div>
        </div>
    </div>

    <!-- Communication Hub -->
    <div class="feature-card">
        <div class="feature-card-header">
            <span class="feature-card-icon">ğŸ“§</span>
            <h3>Communication Center</h3>
        </div>
        <div class="feature-card-body">
            <p>Handle official communications, send notifications to members, and manage correspondence with external parties.</p>
            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                <a href="/secretary/communications/" class="btn btn-success" style="flex: 1;">Send Communications</a>
                <a href="/secretary/templates/" class="btn btn-outline" style="flex: 1;">Templates</a>
            </div>
        </div>
    </div>

    <!-- Meeting Management -->
    <div class="feature-card">
        <div class="feature-card-header">
            <span class="feature-card-icon">ğŸ“</span>
            <h3>Meeting Management</h3>
        </div>
        <div class="feature-card-body">
            <p>Schedule meetings, prepare agendas, record minutes, and track action items. Maintain comprehensive meeting records.</p>
            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                <a href="/secretary/meetings/" class="btn btn-accent" style="flex: 1;">Meeting Center</a>
                <a href="/secretary/minutes/" class="btn btn-outline" style="flex: 1;">Minutes Archive</a>
            </div>
        </div>
    </div>

    <!-- Documentation System -->
    <div class="feature-card">
        <div class="feature-card-header">
            <span class="feature-card-icon">ğŸ“‘</span>
            <h3>Documentation</h3>
        </div>
        <div class="feature-card-body">
            <p>Create and maintain official documentation, policies, and procedural guidelines. Ensure compliance and standardization.</p>
            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                <a href="/secretary/documents/" class="btn btn-primary" style="flex: 1;">Document Hub</a>
                <a href="/secretary/policies/" class="btn btn-outline" style="flex: 1;">Policies</a>
            </div>
        </div>
    </div>
</div>

<!-- Pending Administrative Tasks -->
<div class="interactive-section">
    <div class="section-header">
        <h2>Pending Administrative Tasks</h2>
        <p>Stay on top of your administrative responsibilities and deadlines</p>
    </div>

    {% if pending_tasks %}
    <div class="modern-table">
        <table>
            <thead>
                <tr>
                    <th>Task Type</th>
                    <th>Description</th>
                    <th>Club/Department</th>
                    <th>Due Date</th>
                    <th>Priority</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for task in pending_tasks %}
                <tr>
                    <td>
                        {% if task.type == 'MINUTES' %}
                            <span class="status-badge" style="background: rgba(44, 90, 160, 0.1); color: var(--primary-main);">ğŸ“ Minutes</span>
                        {% elif task.type == 'COMMUNICATION' %}
                            <span class="status-badge" style="background: rgba(56, 161, 105, 0.1); color: var(--accent-emerald);">ğŸ“§ Communication</span>
                        {% elif task.type == 'RECORD_UPDATE' %}
                            <span class="status-badge" style="background: rgba(214, 158, 46, 0.1); color: var(--accent-gold);">ğŸ“‚ Records</span>
                        {% else %}
                            <span class="status-badge">{{ task.type }}</span>
                        {% endif %}
                    </td>
                    <td><strong>{{ task.description }}</strong></td>
                    <td>{{ task.related_entity }}</td>
                    <td>{{ task.due_date|date:"M d, Y" }}</td>
                    <td>
                        {% if task.priority == 'HIGH' %}
                            <span class="status-badge status-error">High</span>
                        {% elif task.priority == 'MEDIUM' %}
                            <span class="status-badge status-warning">Medium</span>
                        {% else %}
                            <span class="status-badge status-success">Low</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if task.status == 'IN_PROGRESS' %}
                            <span class="status-badge" style="background: rgba(66, 153, 225, 0.1); color: var(--info);">In Progress</span>
                        {% elif task.status == 'PENDING' %}
                            <span class="status-badge status-warning">Pending</span>
                        {% elif task.status == 'REVIEW' %}
                            <span class="status-badge" style="background: rgba(153, 102, 255, 0.1); color: var(--accent-purple);">Review</span>
                        {% else %}
                            <span class="status-badge">{{ task.status }}</span>
                        {% endif %}
                    </td>
                    <td>
                        <div style="display: flex; gap: 0.5rem;">
                            <a href="/secretary/task/{{ task.id }}/" class="btn btn-primary" style="padding: 0.5rem; font-size: 0.75rem;">Work On</a>
                            <a href="/secretary/task/{{ task.id }}/complete/" class="btn btn-outline" style="padding: 0.5rem; font-size: 0.75rem;">Complete</a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state">
        <h3>All Tasks Up to Date! ğŸ‰</h3>
        <p>Excellent work! All administrative tasks are current. Ready to take on new challenges!</p>
        <a href="/secretary/tasks/new/" class="btn btn-primary">Create New Task</a>
    </div>
    {% endif %}
</div>

<!-- Administrative Performance Metrics -->
<div class="interactive-section">
    <div class="section-header">
        <h2>Administrative Performance</h2>
        <p>Track your efficiency and impact in administrative operations</p>
    </div>
    
    <div class="card-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
        <div class="feature-card">
            <div class="feature-card-header">
                <span class="feature-card-icon">âš¡</span>
                <h3>Task Completion Rate</h3>
            </div>
            <div class="feature-card-body">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--accent-emerald); margin-bottom: 0.5rem;">
                    {{ task_completion_rate|default:96 }}%
                </div>
                <p style="margin-bottom: 1rem;">Administrative tasks completed on time</p>
                <div style="background: var(--surface-tertiary); height: 8px; border-radius: 4px; overflow: hidden;">
                    <div style="background: linear-gradient(90deg, var(--accent-emerald), #48bb78); height: 100%; width: {{ task_completion_rate|default:96 }}%; border-radius: 4px; transition: width 1s ease;"></div>
                </div>
                <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;">Excellent efficiency</small>
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-card-header">
                <span class="feature-card-icon">ğŸ“ˆ</span>
                <h3>Communication Effectiveness</h3>
            </div>
            <div class="feature-card-body">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary-main); margin-bottom: 0.5rem;">
                    {{ communication_effectiveness|default:92 }}%
                </div>
                <p style="margin-bottom: 1rem;">Positive response rate to communications</p>
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                    <span style="color: var(--accent-emerald); font-size: 0.875rem;">â†— +8%</span>
                    <span style="color: var(--text-muted); font-size: 0.875rem;">improvement this month</span>
                </div>
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-card-header">
                <span class="feature-card-icon">ğŸ¯</span>
                <h3>Record Accuracy</h3>
            </div>
            <div class="feature-card-body">
                <div style="font-size: 2.5rem; font-weight: 700; color: var(--accent-gold); margin-bottom: 0.5rem;">
                    {{ record_accuracy|default:99.2 }}%
                </div>
                <p style="margin-bottom: 1rem;">Data accuracy in maintained records</p>
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                    <span style="color: var(--accent-gold); font-size: 0.875rem;">ğŸ¯ Exceptional</span>
                    <span style="color: var(--text-muted); font-size: 0.875rem;">attention to detail</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Secretary Toolkit -->
<div class="interactive-section">
    <div class="section-header">
        <h2>Secretary Toolkit</h2>
        <p>Essential tools and resources for efficient administrative management</p>
    </div>
    
    <div class="card-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
        <div style="background: var(--surface-primary); padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); text-align: center; border-left: 4px solid var(--primary-main);">
            <div style="font-size: 2rem; margin-bottom: 0.75rem;">ğŸ“‹</div>
            <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Meeting Planner</h4>
            <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">Schedule and organize meetings efficiently</p>
            <a href="/secretary/meeting-planner/" class="btn btn-outline" style="width: 100%; padding: 0.75rem;">Plan Meetings</a>
        </div>

        <div style="background: var(--surface-primary); padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); text-align: center; border-left: 4px solid var(--accent-emerald);">
            <div style="font-size: 2rem; margin-bottom: 0.75rem;">ğŸ“„</div>
            <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Document Templates</h4>
            <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">Access standardized document templates</p>
            <a href="/secretary/templates/" class="btn btn-outline" style="width: 100%; padding: 0.75rem;">Browse Templates</a>
        </div>

        <div style="background: var(--surface-primary); padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); text-align: center; border-left: 4px solid var(--accent-gold);">
            <div style="font-size: 2rem; margin-bottom: 0.75rem;">ğŸ”</div>
            <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Record Search</h4>
            <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">Quickly find and retrieve specific records</p>
            <a href="/secretary/search/" class="btn btn-outline" style="width: 100%; padding: 0.75rem;">Search Records</a>
        </div>

        <div style="background: var(--surface-primary); padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); text-align: center; border-left: 4px solid var(--info);">
            <div style="font-size: 2rem; margin-bottom: 0.75rem;">ğŸ“Š</div>
            <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Administrative Reports</h4>
            <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">Generate comprehensive administrative reports</p>
            <a href="/secretary/reports/" class="btn btn-outline" style="width: 100%; padding: 0.75rem;">Generate Reports</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate secretary statistics
    const statNumbers = document.querySelectorAll('.stat-card .number');
    statNumbers.forEach((number, index) => {
        const finalValue = parseFloat(number.textContent);
        let currentValue = 0;
        const isDecimal = finalValue % 1 !== 0;
        const increment = isDecimal ? finalValue / 50 : Math.ceil(finalValue / 50);
        
        const counter = setInterval(() => {
            currentValue += increment;
            if (currentValue >= finalValue) {
                number.textContent = finalValue;
                clearInterval(counter);
            } else {
                number.textContent = isDecimal ? currentValue.toFixed(1) : Math.floor(currentValue);
            }
        }, 35);
    });

    // Task priority highlighting
    document.querySelectorAll('.status-badge.status-error').forEach(badge => {
        const row = badge.closest('tr');
        if (badge.textContent.trim() === 'High' && row) {
            row.style.borderLeft = '3px solid var(--error)';
            row.style.background = 'rgba(245, 101, 101, 0.02)';
        }
    });

    // Secretary-specific administrative features
    const adminButtons = document.querySelectorAll('a[href*="/secretary/"]');
    adminButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            // Add professional administrative feedback
            this.style.transform = 'scale(0.97)';
            setTimeout(() => {
                this.style.transform = '';
            }, 150);
        });
    });

    // Progress tracking for administrative tasks
    setTimeout(() => {
        const progressBars = document.querySelectorAll('[style*="width:"][style*="%"]');
        progressBars.forEach((bar, index) => {
            const width = bar.style.width;
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.width = width;
            }, 300 * (index + 1));
        });
    }, 1000);

    // Document management efficiency tracker
    const documentButtons = document.querySelectorAll('a[href*="document"], a[href*="record"]');
    documentButtons.forEach(button => {
        button.addEventListener('click', function() {
            console.log('Document access:', this.href);
            // Track document access patterns for efficiency analysis
        });
    });
});
</script>
{% endblock %}
